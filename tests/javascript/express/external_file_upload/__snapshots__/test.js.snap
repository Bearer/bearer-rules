// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`javascript_express_external_file_upload ok_send_file 1`] = `"{}"`;

exports[`javascript_express_external_file_upload send_file_with_external_input 1`] = `
"{
  "low": [
    {
      "cwe_ids": [
        "73"
      ],
      "id": "javascript_express_external_file_upload",
      "title": "External control of filename or path detected.",
      "description": "## Description\\nPassing unsanitized user input to the sendFile API is bad practice and can lead to path manipulation, by which attackers can gain access to resources and data outside of the intended scope.\\n\\n## Remediations\\n✅ Set the root option to be an absolute path to a directory\\n\\n\`\`\`javascript\\napp.post(\\"/upload\\", (req, res) => {\\n  var options = {\\n    root: path.join(__dirname, \\"upload\\")\\n  }\\n  res.sendFile(req.params.filename, options)\\n}\\n\`\`\`\\n\\n## Resources\\n- [Express sendFile API reference](http://expressjs.com/en/5x/api.html#res.sendFile)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/javascript_express_external_file_upload",
      "line_number": 12,
      "full_filename": "/tmp/bearer-scan/send_file_with_external_input.js",
      "filename": ".",
      "source": {
        "start": 12,
        "end": 12,
        "column": {
          "start": 3,
          "end": 21
        }
      },
      "sink": {
        "start": 12,
        "end": 12,
        "column": {
          "start": 3,
          "end": 21
        },
        "content": "res.sendFile(file)"
      },
      "parent_line_number": 12,
      "snippet": "res.sendFile(file)",
      "fingerprint": "f39779a929c915fb55fa930e548d6d6f_0",
      "old_fingerprint": "810bde41a13d23d020b32bc1302aa56f_0",
      "code_extract": "  res.sendFile(file)"
    },
    {
      "cwe_ids": [
        "73"
      ],
      "id": "javascript_express_external_file_upload",
      "title": "External control of filename or path detected.",
      "description": "## Description\\nPassing unsanitized user input to the sendFile API is bad practice and can lead to path manipulation, by which attackers can gain access to resources and data outside of the intended scope.\\n\\n## Remediations\\n✅ Set the root option to be an absolute path to a directory\\n\\n\`\`\`javascript\\napp.post(\\"/upload\\", (req, res) => {\\n  var options = {\\n    root: path.join(__dirname, \\"upload\\")\\n  }\\n  res.sendFile(req.params.filename, options)\\n}\\n\`\`\`\\n\\n## Resources\\n- [Express sendFile API reference](http://expressjs.com/en/5x/api.html#res.sendFile)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/javascript_express_external_file_upload",
      "line_number": 13,
      "full_filename": "/tmp/bearer-scan/send_file_with_external_input.js",
      "filename": ".",
      "source": {
        "start": 13,
        "end": 13,
        "column": {
          "start": 3,
          "end": 35
        }
      },
      "sink": {
        "start": 13,
        "end": 13,
        "column": {
          "start": 3,
          "end": 35
        },
        "content": "res.sendFile(path.resolve(file))"
      },
      "parent_line_number": 13,
      "snippet": "res.sendFile(path.resolve(file))",
      "fingerprint": "f39779a929c915fb55fa930e548d6d6f_1",
      "old_fingerprint": "810bde41a13d23d020b32bc1302aa56f_1",
      "code_extract": "  res.sendFile(path.resolve(file))"
    },
    {
      "cwe_ids": [
        "73"
      ],
      "id": "javascript_express_external_file_upload",
      "title": "External control of filename or path detected.",
      "description": "## Description\\nPassing unsanitized user input to the sendFile API is bad practice and can lead to path manipulation, by which attackers can gain access to resources and data outside of the intended scope.\\n\\n## Remediations\\n✅ Set the root option to be an absolute path to a directory\\n\\n\`\`\`javascript\\napp.post(\\"/upload\\", (req, res) => {\\n  var options = {\\n    root: path.join(__dirname, \\"upload\\")\\n  }\\n  res.sendFile(req.params.filename, options)\\n}\\n\`\`\`\\n\\n## Resources\\n- [Express sendFile API reference](http://expressjs.com/en/5x/api.html#res.sendFile)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/javascript_express_external_file_upload",
      "line_number": 14,
      "full_filename": "/tmp/bearer-scan/send_file_with_external_input.js",
      "filename": ".",
      "source": {
        "start": 14,
        "end": 14,
        "column": {
          "start": 3,
          "end": 46
        }
      },
      "sink": {
        "start": 14,
        "end": 14,
        "column": {
          "start": 3,
          "end": 46
        },
        "content": "res.sendFile(req.params.file, {}, () => {})"
      },
      "parent_line_number": 14,
      "snippet": "res.sendFile(req.params.file, {}, () => {})",
      "fingerprint": "f39779a929c915fb55fa930e548d6d6f_2",
      "old_fingerprint": "810bde41a13d23d020b32bc1302aa56f_2",
      "code_extract": "  res.sendFile(req.params.file, {}, () => {})"
    },
    {
      "cwe_ids": [
        "73"
      ],
      "id": "javascript_express_external_file_upload",
      "title": "External control of filename or path detected.",
      "description": "## Description\\nPassing unsanitized user input to the sendFile API is bad practice and can lead to path manipulation, by which attackers can gain access to resources and data outside of the intended scope.\\n\\n## Remediations\\n✅ Set the root option to be an absolute path to a directory\\n\\n\`\`\`javascript\\napp.post(\\"/upload\\", (req, res) => {\\n  var options = {\\n    root: path.join(__dirname, \\"upload\\")\\n  }\\n  res.sendFile(req.params.filename, options)\\n}\\n\`\`\`\\n\\n## Resources\\n- [Express sendFile API reference](http://expressjs.com/en/5x/api.html#res.sendFile)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/javascript_express_external_file_upload",
      "line_number": 15,
      "full_filename": "/tmp/bearer-scan/send_file_with_external_input.js",
      "filename": ".",
      "source": {
        "start": 15,
        "end": 15,
        "column": {
          "start": 3,
          "end": 76
        }
      },
      "sink": {
        "start": 15,
        "end": 15,
        "column": {
          "start": 3,
          "end": 76
        },
        "content": "res.sendFile(\\"file.txt\\", { root: path.join(__dirname, req.params.root) })"
      },
      "parent_line_number": 15,
      "snippet": "res.sendFile(\\"file.txt\\", { root: path.join(__dirname, req.params.root) })",
      "fingerprint": "f39779a929c915fb55fa930e548d6d6f_3",
      "old_fingerprint": "810bde41a13d23d020b32bc1302aa56f_3",
      "code_extract": "  res.sendFile(\\"file.txt\\", { root: path.join(__dirname, req.params.root) })"
    }
  ]
}"
`;
