// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`javascript_express_external_resource ok_known_resource 1`] = `"{}"`;

exports[`javascript_express_external_resource render_external_resource 1`] = `
"{
  "low": [
    {
      "cwe_ids": [
        "706"
      ],
      "id": "javascript_express_external_resource",
      "title": "Rendering of resources resolved from external name or reference detected.",
      "description": "## Description\\nUsing raw unsanitized input when rendering resources is bad practice.\\n\\n## Remediations\\n❌ Avoid passing user or request input to res.render().\\n\\n✅ Sanitize the input or use a safelist\\n\\nWhere it is unavoidable to rely on user input, sanitize the input or use a safelist to keep the rendered resources within the expected scope.\\n\\n\`\`\`javascript\\nvar path = req.body.path\\nif (['users', 'posts', 'pages'].includes(path)) {\\n  return res.render(\`\${path}/success\`)\\n}\\n\`\`\`\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/javascript_express_external_resource",
      "line_number": 9,
      "full_filename": "/tmp/bearer-scan/render_external_resource.js",
      "filename": ".",
      "source": {
        "start": 9,
        "end": 9,
        "column": {
          "start": 10,
          "end": 62
        }
      },
      "sink": {
        "start": 9,
        "end": 9,
        "column": {
          "start": 10,
          "end": 62
        },
        "content": "res.render(req.query.path + \\"/results\\", { page: 1 })"
      },
      "parent_line_number": 9,
      "snippet": "res.render(req.query.path + \\"/results\\", { page: 1 })",
      "fingerprint": "b370881b6e854d7e31487a8465e91ae0_0",
      "old_fingerprint": "d8919012013f508be4d0a0076cba19f1_0",
      "code_extract": "  return res.render(req.query.path + \\"/results\\", { page: 1 })"
    }
  ]
}"
`;
