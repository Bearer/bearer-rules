// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`javascript_express_hardcoded_secret hardcoded_secret_in_jwt 1`] = `
"{
  "high": [
    {
      "cwe_ids": [
        "798"
      ],
      "id": "javascript_express_hardcoded_secret",
      "title": "Usage of hard-coded secret",
      "description": "## Description\\n\\nCode is not a safe place to store secrets. Use environment variables or a secret management system instead.\\n\\n## Remediations\\n\\n❌ Do not store plaintext secrets in your code\\n\\n\`\`\`javascript\\n app.use(\\n  session({\\n    secret: \\"shh-my-secret\\",\\n    name: \\"my-custom-session-name\\",\\n  })\\n)\\n\`\`\`\\n\\n✅ Use environment variables\\n\\n\`\`\`javascript\\n app.use(\\n  session({\\n    secret: process.env.secret,\\n    name: \\"my-custom-session-name\\",\\n  })\\n)\\n\`\`\`\\n\\n✅ Use a secret management system or even better, a key management service (KMS) with encryption\\n\\n## Resources\\n- [OWASP hardcoded passwords](https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password)\\n- [Google Cloud Key Management Service](https://cloud.google.com/kms/docs)\\n- [AWS Key Management Service](https://aws.amazon.com/kms/)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/javascript_express_hardcoded_secret",
      "line_number": 14,
      "full_filename": "/tmp/bearer-scan/hardcoded_secret_in_jwt.js",
      "filename": ".",
      "source": {
        "start": 14,
        "end": 14,
        "column": {
          "start": 3,
          "end": 48
        }
      },
      "sink": {
        "start": 14,
        "end": 14,
        "column": {
          "start": 3,
          "end": 48
        },
        "content": "expressjwt({ secret: \\"my-hardcoded-secret\\" })"
      },
      "parent_line_number": 14,
      "snippet": "expressjwt({ secret: \\"my-hardcoded-secret\\" })",
      "fingerprint": "1cfb7760604e7cc75fe776199e231fb6_0",
      "old_fingerprint": "2c914a536f4a4f72a15ad382685fd5ef_0",
      "code_extract": "  expressjwt({ secret: \\"my-hardcoded-secret\\" }),"
    },
    {
      "cwe_ids": [
        "798"
      ],
      "id": "javascript_express_hardcoded_secret",
      "title": "Usage of hard-coded secret",
      "description": "## Description\\n\\nCode is not a safe place to store secrets. Use environment variables or a secret management system instead.\\n\\n## Remediations\\n\\n❌ Do not store plaintext secrets in your code\\n\\n\`\`\`javascript\\n app.use(\\n  session({\\n    secret: \\"shh-my-secret\\",\\n    name: \\"my-custom-session-name\\",\\n  })\\n)\\n\`\`\`\\n\\n✅ Use environment variables\\n\\n\`\`\`javascript\\n app.use(\\n  session({\\n    secret: process.env.secret,\\n    name: \\"my-custom-session-name\\",\\n  })\\n)\\n\`\`\`\\n\\n✅ Use a secret management system or even better, a key management service (KMS) with encryption\\n\\n## Resources\\n- [OWASP hardcoded passwords](https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password)\\n- [Google Cloud Key Management Service](https://cloud.google.com/kms/docs)\\n- [AWS Key Management Service](https://aws.amazon.com/kms/)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/javascript_express_hardcoded_secret",
      "line_number": 22,
      "full_filename": "/tmp/bearer-scan/hardcoded_secret_in_jwt.js",
      "filename": ".",
      "source": {
        "start": 22,
        "end": 22,
        "column": {
          "start": 1,
          "end": 31
        }
      },
      "sink": {
        "start": 22,
        "end": 22,
        "column": {
          "start": 1,
          "end": 31
        },
        "content": "jwt.sign({ x: 42 }, secret, y)"
      },
      "parent_line_number": 22,
      "snippet": "jwt.sign({ x: 42 }, secret, y)",
      "fingerprint": "1cfb7760604e7cc75fe776199e231fb6_1",
      "old_fingerprint": "2c914a536f4a4f72a15ad382685fd5ef_1",
      "code_extract": "jwt.sign({ x: 42 }, secret, y)"
    },
    {
      "cwe_ids": [
        "798"
      ],
      "id": "javascript_express_hardcoded_secret",
      "title": "Usage of hard-coded secret",
      "description": "## Description\\n\\nCode is not a safe place to store secrets. Use environment variables or a secret management system instead.\\n\\n## Remediations\\n\\n❌ Do not store plaintext secrets in your code\\n\\n\`\`\`javascript\\n app.use(\\n  session({\\n    secret: \\"shh-my-secret\\",\\n    name: \\"my-custom-session-name\\",\\n  })\\n)\\n\`\`\`\\n\\n✅ Use environment variables\\n\\n\`\`\`javascript\\n app.use(\\n  session({\\n    secret: process.env.secret,\\n    name: \\"my-custom-session-name\\",\\n  })\\n)\\n\`\`\`\\n\\n✅ Use a secret management system or even better, a key management service (KMS) with encryption\\n\\n## Resources\\n- [OWASP hardcoded passwords](https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password)\\n- [Google Cloud Key Management Service](https://cloud.google.com/kms/docs)\\n- [AWS Key Management Service](https://aws.amazon.com/kms/)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/javascript_express_hardcoded_secret",
      "line_number": 24,
      "full_filename": "/tmp/bearer-scan/hardcoded_secret_in_jwt.js",
      "filename": ".",
      "source": {
        "start": 24,
        "end": 24,
        "column": {
          "start": 19,
          "end": 43
        }
      },
      "sink": {
        "start": 24,
        "end": 24,
        "column": {
          "start": 19,
          "end": 43
        },
        "content": "jwt2({ secret: secret })"
      },
      "parent_line_number": 24,
      "snippet": "jwt2({ secret: secret })",
      "fingerprint": "1cfb7760604e7cc75fe776199e231fb6_2",
      "old_fingerprint": "2c914a536f4a4f72a15ad382685fd5ef_2",
      "code_extract": "app.get(\\"/bad-2\\", jwt2({ secret: secret }), function (_req, res) {"
    },
    {
      "cwe_ids": [
        "798"
      ],
      "id": "javascript_express_hardcoded_secret",
      "title": "Usage of hard-coded secret",
      "description": "## Description\\n\\nCode is not a safe place to store secrets. Use environment variables or a secret management system instead.\\n\\n## Remediations\\n\\n❌ Do not store plaintext secrets in your code\\n\\n\`\`\`javascript\\n app.use(\\n  session({\\n    secret: \\"shh-my-secret\\",\\n    name: \\"my-custom-session-name\\",\\n  })\\n)\\n\`\`\`\\n\\n✅ Use environment variables\\n\\n\`\`\`javascript\\n app.use(\\n  session({\\n    secret: process.env.secret,\\n    name: \\"my-custom-session-name\\",\\n  })\\n)\\n\`\`\`\\n\\n✅ Use a secret management system or even better, a key management service (KMS) with encryption\\n\\n## Resources\\n- [OWASP hardcoded passwords](https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password)\\n- [Google Cloud Key Management Service](https://cloud.google.com/kms/docs)\\n- [AWS Key Management Service](https://aws.amazon.com/kms/)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/javascript_express_hardcoded_secret",
      "line_number": 29,
      "full_filename": "/tmp/bearer-scan/hardcoded_secret_in_jwt.js",
      "filename": ".",
      "source": {
        "start": 29,
        "end": 29,
        "column": {
          "start": 1,
          "end": 23
        }
      },
      "sink": {
        "start": 29,
        "end": 29,
        "column": {
          "start": 1,
          "end": 23
        },
        "content": "foo({ x: 42 }, secret)"
      },
      "parent_line_number": 29,
      "snippet": "foo({ x: 42 }, secret)",
      "fingerprint": "1cfb7760604e7cc75fe776199e231fb6_3",
      "old_fingerprint": "2c914a536f4a4f72a15ad382685fd5ef_3",
      "code_extract": "foo({ x: 42 }, secret)"
    },
    {
      "cwe_ids": [
        "798"
      ],
      "id": "javascript_express_hardcoded_secret",
      "title": "Usage of hard-coded secret",
      "description": "## Description\\n\\nCode is not a safe place to store secrets. Use environment variables or a secret management system instead.\\n\\n## Remediations\\n\\n❌ Do not store plaintext secrets in your code\\n\\n\`\`\`javascript\\n app.use(\\n  session({\\n    secret: \\"shh-my-secret\\",\\n    name: \\"my-custom-session-name\\",\\n  })\\n)\\n\`\`\`\\n\\n✅ Use environment variables\\n\\n\`\`\`javascript\\n app.use(\\n  session({\\n    secret: process.env.secret,\\n    name: \\"my-custom-session-name\\",\\n  })\\n)\\n\`\`\`\\n\\n✅ Use a secret management system or even better, a key management service (KMS) with encryption\\n\\n## Resources\\n- [OWASP hardcoded passwords](https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password)\\n- [Google Cloud Key Management Service](https://cloud.google.com/kms/docs)\\n- [AWS Key Management Service](https://aws.amazon.com/kms/)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/javascript_express_hardcoded_secret",
      "line_number": 32,
      "full_filename": "/tmp/bearer-scan/hardcoded_secret_in_jwt.js",
      "filename": ".",
      "source": {
        "start": 32,
        "end": 32,
        "column": {
          "start": 1,
          "end": 24
        }
      },
      "sink": {
        "start": 32,
        "end": 32,
        "column": {
          "start": 1,
          "end": 24
        },
        "content": "sign({ x: 42 }, secret)"
      },
      "parent_line_number": 32,
      "snippet": "sign({ x: 42 }, secret)",
      "fingerprint": "1cfb7760604e7cc75fe776199e231fb6_4",
      "old_fingerprint": "2c914a536f4a4f72a15ad382685fd5ef_4",
      "code_extract": "sign({ x: 42 }, secret)"
    },
    {
      "cwe_ids": [
        "798"
      ],
      "id": "javascript_express_hardcoded_secret",
      "title": "Usage of hard-coded secret",
      "description": "## Description\\n\\nCode is not a safe place to store secrets. Use environment variables or a secret management system instead.\\n\\n## Remediations\\n\\n❌ Do not store plaintext secrets in your code\\n\\n\`\`\`javascript\\n app.use(\\n  session({\\n    secret: \\"shh-my-secret\\",\\n    name: \\"my-custom-session-name\\",\\n  })\\n)\\n\`\`\`\\n\\n✅ Use environment variables\\n\\n\`\`\`javascript\\n app.use(\\n  session({\\n    secret: process.env.secret,\\n    name: \\"my-custom-session-name\\",\\n  })\\n)\\n\`\`\`\\n\\n✅ Use a secret management system or even better, a key management service (KMS) with encryption\\n\\n## Resources\\n- [OWASP hardcoded passwords](https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password)\\n- [Google Cloud Key Management Service](https://cloud.google.com/kms/docs)\\n- [AWS Key Management Service](https://aws.amazon.com/kms/)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/javascript_express_hardcoded_secret",
      "line_number": 37,
      "full_filename": "/tmp/bearer-scan/hardcoded_secret_in_jwt.js",
      "filename": ".",
      "source": {
        "start": 37,
        "end": 37,
        "column": {
          "start": 3,
          "end": 49
        }
      },
      "sink": {
        "start": 37,
        "end": 37,
        "column": {
          "start": 3,
          "end": 49
        },
        "content": "expressjwt2({ secret: \\"my-hardcoded-secret\\" })"
      },
      "parent_line_number": 37,
      "snippet": "expressjwt2({ secret: \\"my-hardcoded-secret\\" })",
      "fingerprint": "1cfb7760604e7cc75fe776199e231fb6_5",
      "old_fingerprint": "2c914a536f4a4f72a15ad382685fd5ef_5",
      "code_extract": "  expressjwt2({ secret: \\"my-hardcoded-secret\\" }),"
    }
  ]
}"
`;

exports[`javascript_express_hardcoded_secret hardcoded_secret_in_session 1`] = `
"{
  "high": [
    {
      "cwe_ids": [
        "798"
      ],
      "id": "javascript_express_hardcoded_secret",
      "title": "Usage of hard-coded secret",
      "description": "## Description\\n\\nCode is not a safe place to store secrets. Use environment variables or a secret management system instead.\\n\\n## Remediations\\n\\n❌ Do not store plaintext secrets in your code\\n\\n\`\`\`javascript\\n app.use(\\n  session({\\n    secret: \\"shh-my-secret\\",\\n    name: \\"my-custom-session-name\\",\\n  })\\n)\\n\`\`\`\\n\\n✅ Use environment variables\\n\\n\`\`\`javascript\\n app.use(\\n  session({\\n    secret: process.env.secret,\\n    name: \\"my-custom-session-name\\",\\n  })\\n)\\n\`\`\`\\n\\n✅ Use a secret management system or even better, a key management service (KMS) with encryption\\n\\n## Resources\\n- [OWASP hardcoded passwords](https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password)\\n- [Google Cloud Key Management Service](https://cloud.google.com/kms/docs)\\n- [AWS Key Management Service](https://aws.amazon.com/kms/)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/javascript_express_hardcoded_secret",
      "line_number": 12,
      "full_filename": "/tmp/bearer-scan/hardcoded_secret_in_session.js",
      "filename": ".",
      "source": {
        "start": 12,
        "end": 15,
        "column": {
          "start": 3,
          "end": 5
        }
      },
      "sink": {
        "start": 12,
        "end": 15,
        "column": {
          "start": 3,
          "end": 5
        },
        "content": "session({\\n    name: \\"my-custom-session-name\\",\\n    secret: \\"my-hardcoded-secret\\",\\n  })"
      },
      "parent_line_number": 12,
      "snippet": "session({\\n    name: \\"my-custom-session-name\\",\\n    secret: \\"my-hardcoded-secret\\",\\n  })",
      "fingerprint": "1cfb7760604e7cc75fe776199e231fb6_0",
      "old_fingerprint": "d7b3e3dde37854840dd24e2179af6ca9_0",
      "code_extract": "  session({\\n    name: \\"my-custom-session-name\\",\\n    secret: \\"my-hardcoded-secret\\",\\n  })"
    },
    {
      "cwe_ids": [
        "798"
      ],
      "id": "javascript_express_hardcoded_secret",
      "title": "Usage of hard-coded secret",
      "description": "## Description\\n\\nCode is not a safe place to store secrets. Use environment variables or a secret management system instead.\\n\\n## Remediations\\n\\n❌ Do not store plaintext secrets in your code\\n\\n\`\`\`javascript\\n app.use(\\n  session({\\n    secret: \\"shh-my-secret\\",\\n    name: \\"my-custom-session-name\\",\\n  })\\n)\\n\`\`\`\\n\\n✅ Use environment variables\\n\\n\`\`\`javascript\\n app.use(\\n  session({\\n    secret: process.env.secret,\\n    name: \\"my-custom-session-name\\",\\n  })\\n)\\n\`\`\`\\n\\n✅ Use a secret management system or even better, a key management service (KMS) with encryption\\n\\n## Resources\\n- [OWASP hardcoded passwords](https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_password)\\n- [Google Cloud Key Management Service](https://cloud.google.com/kms/docs)\\n- [AWS Key Management Service](https://aws.amazon.com/kms/)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/javascript_express_hardcoded_secret",
      "line_number": 23,
      "full_filename": "/tmp/bearer-scan/hardcoded_secret_in_session.js",
      "filename": ".",
      "source": {
        "start": 23,
        "end": 23,
        "column": {
          "start": 9,
          "end": 31
        }
      },
      "sink": {
        "start": 23,
        "end": 23,
        "column": {
          "start": 9,
          "end": 31
        },
        "content": "session(sessionConfig)"
      },
      "parent_line_number": 23,
      "snippet": "session(sessionConfig)",
      "fingerprint": "1cfb7760604e7cc75fe776199e231fb6_1",
      "old_fingerprint": "d7b3e3dde37854840dd24e2179af6ca9_1",
      "code_extract": "app.use(session(sessionConfig))"
    }
  ]
}"
`;

exports[`javascript_express_hardcoded_secret ok_no_hardcoded_secrets 1`] = `"{}"`;
