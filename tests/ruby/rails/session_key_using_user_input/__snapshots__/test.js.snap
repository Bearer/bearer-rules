// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`ruby_rails_session_key_using_user_input ok_no_user_input 1`] = `"{}"`;

exports[`ruby_rails_session_key_using_user_input unsafe 1`] = `
"{
  "high": [
    {
      "cwe_ids": [
        "276"
      ],
      "id": "ruby_rails_session_key_using_user_input",
      "title": "User input detected in a session key.",
      "description": "## Description\\nUsing user-defined data in a session key is bad practice and can allow attackers to perform unsafe actions.\\n\\n## Remediations\\n❌ Avoid using user-defined data in session keys\\n\\n## Resources\\n- [OWASP Session management cheat sheet](https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/ruby_rails_session_key_using_user_input",
      "line_number": 1,
      "full_filename": "/tmp/bearer-scan/unsafe.rb",
      "filename": ".",
      "source": {
        "start": 1,
        "end": 1,
        "column": {
          "start": 1,
          "end": 22
        }
      },
      "sink": {
        "start": 1,
        "end": 1,
        "column": {
          "start": 1,
          "end": 22
        },
        "content": "session[params[:key]]"
      },
      "parent_line_number": 1,
      "snippet": "session[params[:key]]",
      "fingerprint": "d52b20e83740e7ccaeb160dfa4789d5c_0",
      "old_fingerprint": "eb1562871c618785f61675b4101796d9_0"
    },
    {
      "cwe_ids": [
        "276"
      ],
      "id": "ruby_rails_session_key_using_user_input",
      "title": "User input detected in a session key.",
      "description": "## Description\\nUsing user-defined data in a session key is bad practice and can allow attackers to perform unsafe actions.\\n\\n## Remediations\\n❌ Avoid using user-defined data in session keys\\n\\n## Resources\\n- [OWASP Session management cheat sheet](https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/ruby_rails_session_key_using_user_input",
      "line_number": 3,
      "full_filename": "/tmp/bearer-scan/unsafe.rb",
      "filename": ".",
      "source": {
        "start": 3,
        "end": 3,
        "column": {
          "start": 1,
          "end": 27
        }
      },
      "sink": {
        "start": 3,
        "end": 3,
        "column": {
          "start": 1,
          "end": 27
        },
        "content": "session[request.env[:key]]"
      },
      "parent_line_number": 3,
      "snippet": "session[request.env[:key]]",
      "fingerprint": "d52b20e83740e7ccaeb160dfa4789d5c_1",
      "old_fingerprint": "eb1562871c618785f61675b4101796d9_1"
    },
    {
      "cwe_ids": [
        "276"
      ],
      "id": "ruby_rails_session_key_using_user_input",
      "title": "User input detected in a session key.",
      "description": "## Description\\nUsing user-defined data in a session key is bad practice and can allow attackers to perform unsafe actions.\\n\\n## Remediations\\n❌ Avoid using user-defined data in session keys\\n\\n## Resources\\n- [OWASP Session management cheat sheet](https://cheatsheetseries.owasp.org/cheatsheets/Session_Management_Cheat_Sheet.html)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/ruby_rails_session_key_using_user_input",
      "line_number": 5,
      "full_filename": "/tmp/bearer-scan/unsafe.rb",
      "filename": ".",
      "source": {
        "start": 5,
        "end": 5,
        "column": {
          "start": 1,
          "end": 35
        }
      },
      "sink": {
        "start": 5,
        "end": 5,
        "column": {
          "start": 1,
          "end": 35
        },
        "content": "session[\\"test-#{cookies[\\"oops\\"]}\\"]"
      },
      "parent_line_number": 5,
      "snippet": "session[\\"test-#{cookies[\\"oops\\"]}\\"]",
      "fingerprint": "d52b20e83740e7ccaeb160dfa4789d5c_2",
      "old_fingerprint": "eb1562871c618785f61675b4101796d9_2"
    }
  ]
}"
`;
