// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`ruby_lang_reflection_using_user_input ok_not_unsafe 1`] = `"{}"`;

exports[`ruby_lang_reflection_using_user_input unsafe_rails 1`] = `
"{
  "high": [
    {
      "cwe_ids": [
        "94"
      ],
      "id": "ruby_lang_reflection_using_user_input",
      "title": "Use of reflection influenced by user input detected.",
      "description": "## Description\\n\\nApplications should not look up or manipulate code using user-supplied data.\\n\\n## Remediations\\n\\n❌ Avoid using user input when using reflection:\\n\\n\`\`\`ruby\\nmethod(params[:method])\\n\`\`\`\\n\\n✅ Use user input indirectly when using reflection:\\n\\n\`\`\`ruby\\nmethod_name =\\n  case params[:action]\\n  when \\"option1\\"\\n    \\"method1\\"\\n  when \\"option2\\"\\n    \\"method2\\"\\n  end\\n\\nmethod(method_name)\\n\`\`\`\\n\\n## Resources\\n- [OWASP Code injection explained](https://owasp.org/www-community/attacks/Code_Injection)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/ruby_lang_reflection_using_user_input",
      "line_number": 1,
      "full_filename": "/tmp/bearer-scan/unsafe_rails.rb",
      "filename": ".",
      "source": {
        "start": 1,
        "end": 1,
        "column": {
          "start": 1,
          "end": 27
        }
      },
      "sink": {
        "start": 1,
        "end": 1,
        "column": {
          "start": 1,
          "end": 27
        },
        "content": "params[:class].constantize"
      },
      "parent_line_number": 1,
      "snippet": "params[:class].constantize",
      "fingerprint": "23f90aa15d412fbb5e8bd9ead1b2472a_0",
      "old_fingerprint": "e2b58440235b5b3f6308434273c00db6_0",
      "code_extract": "params[:class].constantize"
    },
    {
      "cwe_ids": [
        "94"
      ],
      "id": "ruby_lang_reflection_using_user_input",
      "title": "Use of reflection influenced by user input detected.",
      "description": "## Description\\n\\nApplications should not look up or manipulate code using user-supplied data.\\n\\n## Remediations\\n\\n❌ Avoid using user input when using reflection:\\n\\n\`\`\`ruby\\nmethod(params[:method])\\n\`\`\`\\n\\n✅ Use user input indirectly when using reflection:\\n\\n\`\`\`ruby\\nmethod_name =\\n  case params[:action]\\n  when \\"option1\\"\\n    \\"method1\\"\\n  when \\"option2\\"\\n    \\"method2\\"\\n  end\\n\\nmethod(method_name)\\n\`\`\`\\n\\n## Resources\\n- [OWASP Code injection explained](https://owasp.org/www-community/attacks/Code_Injection)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/ruby_lang_reflection_using_user_input",
      "line_number": 3,
      "full_filename": "/tmp/bearer-scan/unsafe_rails.rb",
      "filename": ".",
      "source": {
        "start": 3,
        "end": 3,
        "column": {
          "start": 10,
          "end": 47
        }
      },
      "sink": {
        "start": 3,
        "end": 3,
        "column": {
          "start": 10,
          "end": 47
        },
        "content": "current_user.try(params[:profession])"
      },
      "parent_line_number": 3,
      "snippet": "current_user.try(params[:profession])",
      "fingerprint": "23f90aa15d412fbb5e8bd9ead1b2472a_1",
      "old_fingerprint": "e2b58440235b5b3f6308434273c00db6_1",
      "code_extract": "raise if current_user.try(params[:profession]) == \\"hacker\\""
    }
  ]
}"
`;

exports[`ruby_lang_reflection_using_user_input unsafe_stdlib 1`] = `
"{
  "high": [
    {
      "cwe_ids": [
        "94"
      ],
      "id": "ruby_lang_reflection_using_user_input",
      "title": "Use of reflection influenced by user input detected.",
      "description": "## Description\\n\\nApplications should not look up or manipulate code using user-supplied data.\\n\\n## Remediations\\n\\n❌ Avoid using user input when using reflection:\\n\\n\`\`\`ruby\\nmethod(params[:method])\\n\`\`\`\\n\\n✅ Use user input indirectly when using reflection:\\n\\n\`\`\`ruby\\nmethod_name =\\n  case params[:action]\\n  when \\"option1\\"\\n    \\"method1\\"\\n  when \\"option2\\"\\n    \\"method2\\"\\n  end\\n\\nmethod(method_name)\\n\`\`\`\\n\\n## Resources\\n- [OWASP Code injection explained](https://owasp.org/www-community/attacks/Code_Injection)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/ruby_lang_reflection_using_user_input",
      "line_number": 1,
      "full_filename": "/tmp/bearer-scan/unsafe_stdlib.rb",
      "filename": ".",
      "source": {
        "start": 1,
        "end": 1,
        "column": {
          "start": 1,
          "end": 33
        }
      },
      "sink": {
        "start": 1,
        "end": 1,
        "column": {
          "start": 1,
          "end": 33
        },
        "content": "Object.const_get(params[:class])"
      },
      "parent_line_number": 1,
      "snippet": "Object.const_get(params[:class])",
      "fingerprint": "23f90aa15d412fbb5e8bd9ead1b2472a_0",
      "old_fingerprint": "0c3f65391f794fe18d98c4cf0a8f9c0a_0",
      "code_extract": "Object.const_get(params[:class])"
    },
    {
      "cwe_ids": [
        "94"
      ],
      "id": "ruby_lang_reflection_using_user_input",
      "title": "Use of reflection influenced by user input detected.",
      "description": "## Description\\n\\nApplications should not look up or manipulate code using user-supplied data.\\n\\n## Remediations\\n\\n❌ Avoid using user input when using reflection:\\n\\n\`\`\`ruby\\nmethod(params[:method])\\n\`\`\`\\n\\n✅ Use user input indirectly when using reflection:\\n\\n\`\`\`ruby\\nmethod_name =\\n  case params[:action]\\n  when \\"option1\\"\\n    \\"method1\\"\\n  when \\"option2\\"\\n    \\"method2\\"\\n  end\\n\\nmethod(method_name)\\n\`\`\`\\n\\n## Resources\\n- [OWASP Code injection explained](https://owasp.org/www-community/attacks/Code_Injection)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/ruby_lang_reflection_using_user_input",
      "line_number": 2,
      "full_filename": "/tmp/bearer-scan/unsafe_stdlib.rb",
      "filename": ".",
      "source": {
        "start": 2,
        "end": 2,
        "column": {
          "start": 1,
          "end": 37
        }
      },
      "sink": {
        "start": 2,
        "end": 2,
        "column": {
          "start": 1,
          "end": 37
        },
        "content": "Object.const_set(params[:class], 42)"
      },
      "parent_line_number": 2,
      "snippet": "Object.const_set(params[:class], 42)",
      "fingerprint": "23f90aa15d412fbb5e8bd9ead1b2472a_1",
      "old_fingerprint": "0c3f65391f794fe18d98c4cf0a8f9c0a_1",
      "code_extract": "Object.const_set(params[:class], 42)"
    },
    {
      "cwe_ids": [
        "94"
      ],
      "id": "ruby_lang_reflection_using_user_input",
      "title": "Use of reflection influenced by user input detected.",
      "description": "## Description\\n\\nApplications should not look up or manipulate code using user-supplied data.\\n\\n## Remediations\\n\\n❌ Avoid using user input when using reflection:\\n\\n\`\`\`ruby\\nmethod(params[:method])\\n\`\`\`\\n\\n✅ Use user input indirectly when using reflection:\\n\\n\`\`\`ruby\\nmethod_name =\\n  case params[:action]\\n  when \\"option1\\"\\n    \\"method1\\"\\n  when \\"option2\\"\\n    \\"method2\\"\\n  end\\n\\nmethod(method_name)\\n\`\`\`\\n\\n## Resources\\n- [OWASP Code injection explained](https://owasp.org/www-community/attacks/Code_Injection)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/ruby_lang_reflection_using_user_input",
      "line_number": 3,
      "full_filename": "/tmp/bearer-scan/unsafe_stdlib.rb",
      "filename": ".",
      "source": {
        "start": 3,
        "end": 3,
        "column": {
          "start": 1,
          "end": 36
        }
      },
      "sink": {
        "start": 3,
        "end": 3,
        "column": {
          "start": 1,
          "end": 36
        },
        "content": "Object.remove_const(params[:class])"
      },
      "parent_line_number": 3,
      "snippet": "Object.remove_const(params[:class])",
      "fingerprint": "23f90aa15d412fbb5e8bd9ead1b2472a_2",
      "old_fingerprint": "0c3f65391f794fe18d98c4cf0a8f9c0a_2",
      "code_extract": "Object.remove_const(params[:class])"
    },
    {
      "cwe_ids": [
        "94"
      ],
      "id": "ruby_lang_reflection_using_user_input",
      "title": "Use of reflection influenced by user input detected.",
      "description": "## Description\\n\\nApplications should not look up or manipulate code using user-supplied data.\\n\\n## Remediations\\n\\n❌ Avoid using user input when using reflection:\\n\\n\`\`\`ruby\\nmethod(params[:method])\\n\`\`\`\\n\\n✅ Use user input indirectly when using reflection:\\n\\n\`\`\`ruby\\nmethod_name =\\n  case params[:action]\\n  when \\"option1\\"\\n    \\"method1\\"\\n  when \\"option2\\"\\n    \\"method2\\"\\n  end\\n\\nmethod(method_name)\\n\`\`\`\\n\\n## Resources\\n- [OWASP Code injection explained](https://owasp.org/www-community/attacks/Code_Injection)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/ruby_lang_reflection_using_user_input",
      "line_number": 5,
      "full_filename": "/tmp/bearer-scan/unsafe_stdlib.rb",
      "filename": ".",
      "source": {
        "start": 5,
        "end": 5,
        "column": {
          "start": 1,
          "end": 24
        }
      },
      "sink": {
        "start": 5,
        "end": 5,
        "column": {
          "start": 1,
          "end": 24
        },
        "content": "method(params[:method])"
      },
      "parent_line_number": 5,
      "snippet": "method(params[:method])",
      "fingerprint": "23f90aa15d412fbb5e8bd9ead1b2472a_3",
      "old_fingerprint": "0c3f65391f794fe18d98c4cf0a8f9c0a_3",
      "code_extract": "method(params[:method])"
    },
    {
      "cwe_ids": [
        "94"
      ],
      "id": "ruby_lang_reflection_using_user_input",
      "title": "Use of reflection influenced by user input detected.",
      "description": "## Description\\n\\nApplications should not look up or manipulate code using user-supplied data.\\n\\n## Remediations\\n\\n❌ Avoid using user input when using reflection:\\n\\n\`\`\`ruby\\nmethod(params[:method])\\n\`\`\`\\n\\n✅ Use user input indirectly when using reflection:\\n\\n\`\`\`ruby\\nmethod_name =\\n  case params[:action]\\n  when \\"option1\\"\\n    \\"method1\\"\\n  when \\"option2\\"\\n    \\"method2\\"\\n  end\\n\\nmethod(method_name)\\n\`\`\`\\n\\n## Resources\\n- [OWASP Code injection explained](https://owasp.org/www-community/attacks/Code_Injection)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/ruby_lang_reflection_using_user_input",
      "line_number": 7,
      "full_filename": "/tmp/bearer-scan/unsafe_stdlib.rb",
      "filename": ".",
      "source": {
        "start": 7,
        "end": 7,
        "column": {
          "start": 1,
          "end": 36
        }
      },
      "sink": {
        "start": 7,
        "end": 7,
        "column": {
          "start": 1,
          "end": 36
        },
        "content": "x.define_method(params[:method]) {}"
      },
      "parent_line_number": 7,
      "snippet": "x.define_method(params[:method]) {}",
      "fingerprint": "23f90aa15d412fbb5e8bd9ead1b2472a_4",
      "old_fingerprint": "0c3f65391f794fe18d98c4cf0a8f9c0a_4",
      "code_extract": "x.define_method(params[:method]) {}"
    },
    {
      "cwe_ids": [
        "94"
      ],
      "id": "ruby_lang_reflection_using_user_input",
      "title": "Use of reflection influenced by user input detected.",
      "description": "## Description\\n\\nApplications should not look up or manipulate code using user-supplied data.\\n\\n## Remediations\\n\\n❌ Avoid using user input when using reflection:\\n\\n\`\`\`ruby\\nmethod(params[:method])\\n\`\`\`\\n\\n✅ Use user input indirectly when using reflection:\\n\\n\`\`\`ruby\\nmethod_name =\\n  case params[:action]\\n  when \\"option1\\"\\n    \\"method1\\"\\n  when \\"option2\\"\\n    \\"method2\\"\\n  end\\n\\nmethod(method_name)\\n\`\`\`\\n\\n## Resources\\n- [OWASP Code injection explained](https://owasp.org/www-community/attacks/Code_Injection)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/ruby_lang_reflection_using_user_input",
      "line_number": 9,
      "full_filename": "/tmp/bearer-scan/unsafe_stdlib.rb",
      "filename": ".",
      "source": {
        "start": 9,
        "end": 9,
        "column": {
          "start": 1,
          "end": 31
        }
      },
      "sink": {
        "start": 9,
        "end": 9,
        "column": {
          "start": 1,
          "end": 31
        },
        "content": "params[:method].to_sym.to_proc"
      },
      "parent_line_number": 9,
      "snippet": "params[:method].to_sym.to_proc",
      "fingerprint": "23f90aa15d412fbb5e8bd9ead1b2472a_5",
      "old_fingerprint": "0c3f65391f794fe18d98c4cf0a8f9c0a_5",
      "code_extract": "params[:method].to_sym.to_proc"
    },
    {
      "cwe_ids": [
        "94"
      ],
      "id": "ruby_lang_reflection_using_user_input",
      "title": "Use of reflection influenced by user input detected.",
      "description": "## Description\\n\\nApplications should not look up or manipulate code using user-supplied data.\\n\\n## Remediations\\n\\n❌ Avoid using user input when using reflection:\\n\\n\`\`\`ruby\\nmethod(params[:method])\\n\`\`\`\\n\\n✅ Use user input indirectly when using reflection:\\n\\n\`\`\`ruby\\nmethod_name =\\n  case params[:action]\\n  when \\"option1\\"\\n    \\"method1\\"\\n  when \\"option2\\"\\n    \\"method2\\"\\n  end\\n\\nmethod(method_name)\\n\`\`\`\\n\\n## Resources\\n- [OWASP Code injection explained](https://owasp.org/www-community/attacks/Code_Injection)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/ruby_lang_reflection_using_user_input",
      "line_number": 11,
      "full_filename": "/tmp/bearer-scan/unsafe_stdlib.rb",
      "filename": ".",
      "source": {
        "start": 11,
        "end": 11,
        "column": {
          "start": 1,
          "end": 36
        }
      },
      "sink": {
        "start": 11,
        "end": 11,
        "column": {
          "start": 1,
          "end": 36
        },
        "content": "bad_things(&params[:method].to_sym)"
      },
      "parent_line_number": 11,
      "snippet": "bad_things(&params[:method].to_sym)",
      "fingerprint": "23f90aa15d412fbb5e8bd9ead1b2472a_6",
      "old_fingerprint": "0c3f65391f794fe18d98c4cf0a8f9c0a_6",
      "code_extract": "bad_things(&params[:method].to_sym)"
    },
    {
      "cwe_ids": [
        "94"
      ],
      "id": "ruby_lang_reflection_using_user_input",
      "title": "Use of reflection influenced by user input detected.",
      "description": "## Description\\n\\nApplications should not look up or manipulate code using user-supplied data.\\n\\n## Remediations\\n\\n❌ Avoid using user input when using reflection:\\n\\n\`\`\`ruby\\nmethod(params[:method])\\n\`\`\`\\n\\n✅ Use user input indirectly when using reflection:\\n\\n\`\`\`ruby\\nmethod_name =\\n  case params[:action]\\n  when \\"option1\\"\\n    \\"method1\\"\\n  when \\"option2\\"\\n    \\"method2\\"\\n  end\\n\\nmethod(method_name)\\n\`\`\`\\n\\n## Resources\\n- [OWASP Code injection explained](https://owasp.org/www-community/attacks/Code_Injection)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/ruby_lang_reflection_using_user_input",
      "line_number": 12,
      "full_filename": "/tmp/bearer-scan/unsafe_stdlib.rb",
      "filename": ".",
      "source": {
        "start": 12,
        "end": 12,
        "column": {
          "start": 1,
          "end": 38
        }
      },
      "sink": {
        "start": 12,
        "end": 12,
        "column": {
          "start": 1,
          "end": 38
        },
        "content": "x.bad_things(&params[:method].to_sym)"
      },
      "parent_line_number": 12,
      "snippet": "x.bad_things(&params[:method].to_sym)",
      "fingerprint": "23f90aa15d412fbb5e8bd9ead1b2472a_7",
      "old_fingerprint": "0c3f65391f794fe18d98c4cf0a8f9c0a_7",
      "code_extract": "x.bad_things(&params[:method].to_sym)"
    }
  ]
}"
`;
