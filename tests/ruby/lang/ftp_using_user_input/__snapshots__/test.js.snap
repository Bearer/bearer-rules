// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`ruby_lang_ftp_using_user_input ok_not_unsafe 1`] = `"{}"`;

exports[`ruby_lang_ftp_using_user_input unsafe 1`] = `
"{
  "high": [
    {
      "cwe_ids": [
        "73"
      ],
      "id": "ruby_lang_ftp_using_user_input",
      "title": "Unsanitized user input in FTP request",
      "description": "## Description\\nUsing raw unsanitized input with FTP methods is bad practice.\\nIt could put your application at risk for code injection attacks, or lead to path traversal, by which attackers can gain access to resources outside of the intended scope\\n\\n\\n## Remediations\\n❌ Do not form filenames or file paths for FTP from raw user input\\n\`\`\`ruby\\nNet::FTP.open(\\"public/#{params[\\"resource_name\\"]}.txt\\" do\\n  # ...\\nend\\n\`\`\`\\n❌ Do not pass raw user input as arguments to FTP methods\\n\\n\`\`\`ruby\\nNet::FTP.open(\\"example.txt\\", username: params[:user]) do\\n  # ...\\nend\\n\`\`\`\\n\\n## Resources\\n- [OWASP code injection](https://owasp.org/www-community/attacks/Code_Injection)\\n- [OWASP path traversal](https://owasp.org/www-community/attacks/Path_Traversal)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/ruby_lang_ftp_using_user_input",
      "line_number": 1,
      "full_filename": "/tmp/bearer-scan/unsafe.rb",
      "filename": ".",
      "source": {
        "start": 1,
        "end": 1,
        "column": {
          "start": 1,
          "end": 28
        }
      },
      "sink": {
        "start": 1,
        "end": 1,
        "column": {
          "start": 1,
          "end": 28
        },
        "content": "Net::FTP.new(params[:oops])"
      },
      "parent_line_number": 1,
      "snippet": "Net::FTP.new(params[:oops])",
      "fingerprint": "f44de33c1fcd881c7cadc1c450652253_0",
      "old_fingerprint": "235d514be331689d1435628db74d36b1_0",
      "code_extract": "Net::FTP.new(params[:oops])"
    },
    {
      "cwe_ids": [
        "73"
      ],
      "id": "ruby_lang_ftp_using_user_input",
      "title": "Unsanitized user input in FTP request",
      "description": "## Description\\nUsing raw unsanitized input with FTP methods is bad practice.\\nIt could put your application at risk for code injection attacks, or lead to path traversal, by which attackers can gain access to resources outside of the intended scope\\n\\n\\n## Remediations\\n❌ Do not form filenames or file paths for FTP from raw user input\\n\`\`\`ruby\\nNet::FTP.open(\\"public/#{params[\\"resource_name\\"]}.txt\\" do\\n  # ...\\nend\\n\`\`\`\\n❌ Do not pass raw user input as arguments to FTP methods\\n\\n\`\`\`ruby\\nNet::FTP.open(\\"example.txt\\", username: params[:user]) do\\n  # ...\\nend\\n\`\`\`\\n\\n## Resources\\n- [OWASP code injection](https://owasp.org/www-community/attacks/Code_Injection)\\n- [OWASP path traversal](https://owasp.org/www-community/attacks/Path_Traversal)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/ruby_lang_ftp_using_user_input",
      "line_number": 3,
      "full_filename": "/tmp/bearer-scan/unsafe.rb",
      "filename": ".",
      "source": {
        "start": 3,
        "end": 5,
        "column": {
          "start": 1,
          "end": 4
        }
      },
      "sink": {
        "start": 3,
        "end": 5,
        "column": {
          "start": 1,
          "end": 4
        },
        "content": "Net::FTP.open(\\"example.com\\", username: params[:user]) do\\n\\nend"
      },
      "parent_line_number": 3,
      "snippet": "Net::FTP.open(\\"example.com\\", username: params[:user]) do\\n\\nend",
      "fingerprint": "f44de33c1fcd881c7cadc1c450652253_1",
      "old_fingerprint": "235d514be331689d1435628db74d36b1_1",
      "code_extract": "Net::FTP.open(\\"example.com\\", username: params[:user]) do\\n\\nend"
    },
    {
      "cwe_ids": [
        "73"
      ],
      "id": "ruby_lang_ftp_using_user_input",
      "title": "Unsanitized user input in FTP request",
      "description": "## Description\\nUsing raw unsanitized input with FTP methods is bad practice.\\nIt could put your application at risk for code injection attacks, or lead to path traversal, by which attackers can gain access to resources outside of the intended scope\\n\\n\\n## Remediations\\n❌ Do not form filenames or file paths for FTP from raw user input\\n\`\`\`ruby\\nNet::FTP.open(\\"public/#{params[\\"resource_name\\"]}.txt\\" do\\n  # ...\\nend\\n\`\`\`\\n❌ Do not pass raw user input as arguments to FTP methods\\n\\n\`\`\`ruby\\nNet::FTP.open(\\"example.txt\\", username: params[:user]) do\\n  # ...\\nend\\n\`\`\`\\n\\n## Resources\\n- [OWASP code injection](https://owasp.org/www-community/attacks/Code_Injection)\\n- [OWASP path traversal](https://owasp.org/www-community/attacks/Path_Traversal)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/ruby_lang_ftp_using_user_input",
      "line_number": 9,
      "full_filename": "/tmp/bearer-scan/unsafe.rb",
      "filename": ".",
      "source": {
        "start": 9,
        "end": 9,
        "column": {
          "start": 3,
          "end": 50
        }
      },
      "sink": {
        "start": 9,
        "end": 9,
        "column": {
          "start": 3,
          "end": 50
        },
        "content": "ftp.puttextfile(\\"local.txt\\", event[\\"filename\\"])"
      },
      "parent_line_number": 9,
      "snippet": "ftp.puttextfile(\\"local.txt\\", event[\\"filename\\"])",
      "fingerprint": "f44de33c1fcd881c7cadc1c450652253_2",
      "old_fingerprint": "235d514be331689d1435628db74d36b1_2",
      "code_extract": "  ftp.puttextfile(\\"local.txt\\", event[\\"filename\\"])"
    }
  ]
}"
`;
