// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`java_lang_ldap_injection ldap_injection 1`] = `
"{
  "low": [
    {
      "cwe_ids": [
        "90"
      ],
      "id": "java_lang_ldap_injection",
      "title": "Unsanitized user input in LDAP request",
      "description": "## Description\\n  Unsatized input going into LDAP query detected. This could lead to LDAP injection, which could result in attackers modifying objects in the LDAP tree structure. Ensure data passed to an LDAP query is not controllable or properly sanitize the data.\\n\\n## Remediations\\n\\nâœ… Sanitize LDAP query data\\n\\n\`\`\`java\\n  public class Cls extends HttpServlet\\n  {\\n\\n      public void handleRequest(HttpServletRequest request, HttpServletResponse response)\\n      {\\n          String userID = request.getParameter(\\"userID\\");\\n          String sanitizedUserID = sanitize(userID);\\n\\n          String filter = \\"(&(objectclass=person))(|(uid=\\" + sanitizedUserID + \\")(street={0}))\\";\\n          String base = \\"ou=users,ou=system\\";\\n          Object[] filters = new Object[] {\\"First avenue\\"};\\n          javax.naming.directory.SearchControls sc = new javax.naming.directory.SearchControls();\\n\\n          dirContext.search(base, filter, filters, sc);\\n      }\\n  }\\n\`\`\`\\n\\n## References\\n- [LDAP Injection](https://owasp.org/www-community/attacks/LDAP_Injection)\\n- [LDAP Injection Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/LDAP_Injection_Prevention_Cheat_Sheet.html)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/java_lang_ldap_injection",
      "line_number": 17,
      "full_filename": "/tmp/bearer-scan/ldap_injection.java",
      "filename": ".",
      "source": {
        "start": 17,
        "end": 17,
        "column": {
          "start": 9,
          "end": 53
        }
      },
      "sink": {
        "start": 17,
        "end": 17,
        "column": {
          "start": 9,
          "end": 53
        },
        "content": "dirContext.search(base, filter, filters, sc)"
      },
      "parent_line_number": 17,
      "snippet": "dirContext.search(base, filter, filters, sc)",
      "fingerprint": "0bad406b42c52ab03e6e7a64c501440d_0",
      "old_fingerprint": "091cee7b38ff59746e5d6fb2bdb8328a_0",
      "code_extract": "        dirContext.search(base, filter, filters, sc);"
    }
  ]
}"
`;
