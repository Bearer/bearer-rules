// Jest Snapshot v1, https://goo.gl/fbAQLP

exports[`go_gosec_filesystem_poor_write_permissions test 1`] = `
"{
  "low": [
    {
      "cwe_ids": [
        "276"
      ],
      "id": "go_gosec_filesystem_poor_write_permissions",
      "title": "Permissive file creation",
      "description": "## Description\\n\\nThe application has been detected setting file permissions that are too permissive. This configuration could allow unauthorized users to read, write, or execute files, potentially leading to information disclosure or other security vulnerabilities.\\n\\n## Remediations\\n\\nTo enhance security, file permissions should be set to more restrictive values, especially when the files contain sensitive information:\\n\\n✅ Use Restrictive File Permissions\\n\\nAssign file permissions to limit access appropriately based on the application's requirements.\\n\\n- \`0400\`: Grants read-only access to the file for the owner.\\n- \`0200\`: Grants write-only access to the file for the owner.\\n- \`0600\`: Grants read and write access to the file for the owner.\\n\\n✅ Apply Permissions During File Creation\\n\\nWhen creating or modifying files, set the appropriate permissions to prevent unauthorized access.\\n\\n\`\`\`go\\nimport (\\n    \\"os\\"\\n    \\"log\\"\\n)\\n\\nfunc main() {\\n    // Data to be written to the file\\n    dat := []byte(\\"sensitive data\\")\\n\\n    // Write the data to 'file.txt' with read and write permissions for the owner only\\n    if err := os.WriteFile(\\"file.txt\\", dat, 0600); err != nil {\\n        log.Fatalf(\\"failed to write file: %s\\", err)\\n    }\\n    // File is now safely written with restricted permissions\\n}\\n\`\`\`\\n\\n✅ Review File Permission Settings\\n\\nRegularly audit the permissions of files to ensure they conform to the principle of least privilege.\\n\\n## Resources\\n\\n- [Go Documentation for os Package](https://pkg.go.dev/os)\\n- [Linux 'chmod' Command](https://linux.die.net/man/1/chmod)\\n- [OWASP File Handling Best Practices](https://cheatsheetseries.owasp.org/cheatsheets/File_Upload_Cheat_Sheet.html)\\n",
      "documentation_url": "https://docs.bearer.com/reference/rules/go_gosec_filesystem_poor_write_permissions",
      "line_number": 19,
      "full_filename": "/tmp/bearer-scan/main.go",
      "filename": ".",
      "source": {
        "start": 19,
        "end": 19,
        "column": {
          "start": 9,
          "end": 48
        }
      },
      "sink": {
        "start": 19,
        "end": 19,
        "column": {
          "start": 9,
          "end": 48
        },
        "content": "ioutil.WriteFile(\\"/tmp/dat1\\", d1, 0744)"
      },
      "parent_line_number": 19,
      "snippet": "ioutil.WriteFile(\\"/tmp/dat1\\", d1, 0744)",
      "fingerprint": "608e26e1e7ff94dddcae86ff0bb9a03b_0",
      "old_fingerprint": "bea73efa91d0340a983a52974a790bff_0",
      "code_extract": "\\terr := ioutil.WriteFile(\\"/tmp/dat1\\", d1, 0744)"
    }
  ]
}"
`;
