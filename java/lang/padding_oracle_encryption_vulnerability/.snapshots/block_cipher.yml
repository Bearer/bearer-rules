low:
    - rule:
        cwe_ids:
            - "327"
        id: java_lang_padding_oracle_encryption_vulnerability
        title: Padding Oracle encryption vulnerability detected.
        description: |
            ## Description

            Using a block cipher algorithm mode, such as CBC, together with a padding scheme is vulnerable to Padding Oracle attacks.

            ## Remediations

            ❌  Do not use CBC (Cipher Block Chaining) mode with padding

            ```java
              Cipher c = Cipher.getInstance("AES/CBC/PKCS5Padding");
            ```

            ✅ Prefer GCM (Galois/Counter Mode) instead

            ```java
              Cipher c = Cipher.getInstance("AES/GCM/PKCS5Padding");
            ```

            ## Resources
            - [Java Cipher class](https://docs.oracle.com/en/java/javase/20/docs/api/java.base/javax/crypto/Cipher.html)
            - [Java Security Standard Algorithm Names](https://docs.oracle.com/en/java/javase/20/docs/specs/security/standard-names.html)
        documentation_url: https://docs.bearer.com/reference/rules/java_lang_padding_oracle_encryption_vulnerability
      line_number: 3
      full_filename: /tmp/scan/block_cipher.java
      filename: .
      source:
        location:
            start: 3
            end: 3
            column:
                start: 14
                end: 69
      sink:
        location:
            start: 3
            end: 3
            column:
                start: 14
                end: 69
        content: javax.crypto.Cipher.getInstance("AES/CBC/PKCS5Padding")
      parent_line_number: 3
      snippet: javax.crypto.Cipher.getInstance("AES/CBC/PKCS5Padding")
      fingerprint: 368142b7ce98efcf47351ef4a2c2dab7_0
      old_fingerprint: 83661fbb9de19d845a95fe1686f115bb_0

