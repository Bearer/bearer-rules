type: shared
languages:
  - javascript
imports:
  - javascript_shared_aws_lambda_user_input
  - javascript_shared_express_user_input
sanitizer: javascript_shared_common_user_input_sanitized
patterns:
  - pattern: const { $<!>$<_> } = $<JAVASCRIPT_SHARED_COMMON_USER_INPUT_DESTRUCTURED>
    filters:
      - variable: JAVASCRIPT_SHARED_COMMON_USER_INPUT_DESTRUCTURED
        detection: javascript_shared_common_user_input
  - pattern: $<JAVASCRIPT_SHARED_COMMON_USER_INPUT>
    filters:
      - either:
          - variable: JAVASCRIPT_SHARED_COMMON_USER_INPUT
            detection: javascript_shared_aws_lambda_user_input
            contains: false
          - variable: JAVASCRIPT_SHARED_COMMON_USER_INPUT
            detection: javascript_shared_express_user_input
            contains: false
auxiliary:
  - id: javascript_shared_common_user_input_sanitized
    patterns:
      - pattern: |
          !$<!>$<_>
metadata:
  description: "Javascript user input."
  id: javascript_shared_common_user_input
