type: shared
languages:
  - php
imports:
  - php_shared_symfony_user_input
sanitizer: php_shared_lang_user_input_sanitized
patterns:
  - pattern: $$<METHOD>[$<_>]
    filters:
      - variable: METHOD
        values:
          - _GET
          - _POST
  - pattern: $<SYMFONY_USER_INPUT>;
    filters:
      - variable: SYMFONY_USER_INPUT
        detection: php_shared_symfony_user_input
        scope: cursor_strict
auxiliary:
  - id: php_shared_lang_user_input_sanitized
    patterns:
      - count($<_>)
      - filter_var($<!>$<_>$<...>)

metadata:
  description: "PHP user input."
  id: php_shared_lang_user_input
