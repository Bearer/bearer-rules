type: shared
languages:
  - python
patterns:
  - pattern: $<REQUEST>.$<METHOD>.get()
    filters:
      - variable: REQUEST
        detection: python_shared_django_user_input_request
        scope: cursor
      - variable: METHOD
        regex: (?i)\A(post|files|get|data|query_params|content_type|stream)\z
  - pattern: $<REQUEST>.$<METHOD>[$<_>]
    filters:
      - variable: REQUEST
        detection: python_shared_django_user_input_request
        scope: cursor
      - variable: METHOD
        regex: (?i)\A(post|files|get|data|query_params|content_type|stream)\z
  - pattern: $<FORM>.$<METHOD>[$<_>]
    filters:
      - variable: FORM
        regex: \A(un)?(bound_)?form\z
      - variable: METHOD
        values:
          - data
          - changed_data
          - cleaned_data
  - pattern: $<FORM>[$<_>].value()
    filters:
      - variable: FORM
        regex: \A(un)?(bound_)?form\z
auxiliary:
  - id: python_shared_django_user_input_request
    patterns:
      - request
      - req
      - r
metadata:
  description: "Django user input."
  id: python_shared_django_user_input
