type: shared
languages:
  - python
patterns:
  - pattern: $<REQUEST>.$<METHOD>.get()
    filters:
      - variable: REQUEST
        detection: python_shared_django_user_input_request
        scope: cursor
      - variable: METHOD
        regex: (?i)\A(post|files|get|data|query_params|content_type|stream)\z
  - pattern: $<REQUEST>.$<METHOD>[$<_>]
    filters:
      - variable: REQUEST
        detection: python_shared_django_user_input_request
        scope: cursor
      - variable: METHOD
        regex: (?i)\A(post|files|get|data|query_params|content_type|stream)\z
  - pattern: $<FORM>.$<METHOD>[$<_>]
    filters:
      - variable: FORM
        detection: python_shared_django_user_input_form
        scope: result
      - variable: METHOD
        values:
          - data
          - changed_data
          - cleaned_data
  - pattern: $<FORM>[$<_>].value()
    filters:
      - variable: FORM
        detection: python_shared_django_user_input_form
        scope: result
auxiliary:
  - id: python_shared_django_user_input_form
    patterns:
      - pattern: $<FORM>
        # from <some_form_module> import <SomeFormName>
        # form = FormName(request.POST)
        filters:
          - variable: FORM
            regex: \A(un)?(bound_)?form\z
  - id: python_shared_django_user_input_request
    # passed to a view method e.g. def my_view(request)
    patterns:
      - request
      - req
      - r
metadata:
  description: "Django user input."
  id: python_shared_django_user_input
