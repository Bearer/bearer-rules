type: shared
languages:
  - python
patterns:
  - sys.argv[$<_>]
  - pattern: $<PARSER>.parse_args($<...>)
    filters:
      - variable: PARSER
        detection: python_shared_lang_dynamic_input_parser
        scope: result
  - pattern: $<GETOPT>.getopt($<...>)
    filters:
      - variable: GETOPT
        detection: python_shared_lang_dynamic_input_getopt
        scope: result
auxiliary:
  - id: python_shared_lang_dynamic_input_parser
    patterns:
      - pattern: $<ARG_PARSER>()
        filters:
          - variable: ARG_PARSER
            detection: python_shared_lang_dynamic_input_argument_parser
  - id: python_shared_lang_dynamic_input_argument_parser
    patterns:
      - ArgumentParser # fallback
      - from argparse import ArgumentParser as $<!>$<_>
      - pattern: $<ARGPARSE>.ArgumentParser
        filters:
          - variable: ARGPARSE
            detection: python_shared_lang_dynamic_input_argparse_import
  - id: python_shared_lang_dynamic_input_argparse_import
    patterns:
      - import $<!>argparse
      - import argparse as $<!>$<_>
      - argparse # fallback
  - id: python_shared_lang_dynamic_input_getopt
    patterns:
      - import $<!>getopt
      - import getopt as $<!>$<_>
      - getopt # fallback
metadata:
  description: "Python dynamic input."
  id: python_shared_lang_dynamic_input
