imports:
  - java_shared_lang_instance
patterns:
  - pattern: $<RESPONSE>.addCookie($<INSECURE_COOKIE>)
    # filters:
    #   - variable: RESPONSE
    #     type: javax.servlet.http.HttpServletResponse
    #   - not:
    #       - variable: INSECURE_COOKIE
    #         detection: java_lang_insecure_cookie_secure_cookie
    #         scope: cursor
# auxiliary:
#   - id: java_lang_insecure_cookie_cookie
#     patterns:
#       - pattern: $<COOKIE>
#         filters:
#           - variable: COOKIE
#             type: javax.servlet.http.Cookie
#           - variable: COOKIE
#             field: httpOnly
#             detection: java_lang_insecure_cookie_false
#             scope: cursor
#   - id: java_lang_insecure_cookie_false
#     patterns:
#       - "false;"
languages:
  - java
metadata:
  description: "Missing secure options for cookie detected."
  remediation_message: |
    ## Description

    To make sure cookies don't open your application up to exploits or unauthorized access, make sure to set security options appropriately.

    ## Remediations

    âœ… Set `HttpOnly` to `true` to protect the cookie value from being accessed by client side JavaScript

    ```java
    cookie.setHttpOnly(true);
    ```
  cwe_id:
    - 614
  id: java_lang_insecure_cookie
  documentation_url: https://docs.bearer.com/reference/rules/java_lang_insecure_cookie
  cloud_code_suggestions: true
