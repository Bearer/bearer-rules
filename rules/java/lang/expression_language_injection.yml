imports:
  - java_shared_lang_instance
patterns:
  - pattern: $<EXPRESSION_FACTORY>.$<METHOD>($<EL_CONTEXT>, $<STRING_PARAM>$<...>);
    filters:
      - variable: EXPRESSION_FACTORY
        type: javax.el.ExpressionFactory
      - variable: METHOD
        values:
          - createValueExpression
          - createMethodExpression
      - variable: EL_CONTEXT
        type: javax.el.ELContext
      - variable: STRING_PARAM
        type: String
languages:
  - java
severity: warning
metadata:
  description: "Possible expression language (EL) injection detected."
  remediation_message: |
    ## Description

    Using external input when building an expression language (EL) statement can lead to EL injection attacks and the evaluation of risky code.

    ## Remediations

    âœ… Always validate the source of external input or dynamic values before using them to construct EL statements

    ## Resources
    - [OWASP Expression Language Injection](https://owasp.org/www-community/vulnerabilities/Expression_Language_Injection)
  cwe_id:
    - 917
    - 94
  id: java_lang_expression_language_injection
  documentation_url: https://docs.bearer.com/reference/rules/java_lang_expression_language_injection
