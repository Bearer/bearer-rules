imports:
  - go_shared_lang_dynamic_input_combined
patterns:
  - pattern: $<XML>.Unmarshal($<USER_INPUT>$<...>)
    filters:
      - variable: XML
        detection: go_lang_xml_external_entity_vulnerability_xml_init
      - variable: USER_INPUT
        detection: go_shared_lang_dynamic_input_combined
auxiliary:
  - id: go_lang_xml_external_entity_vulnerability_xml_init
    patterns:
      - import $<!>"encoding/xml"
      - |
        import (
          $<!>"encoding/xml"
        )
languages:
  - go
severity: critical
metadata:
  description: Unsanitized user input in XML External Entity
  remediation_message: |-
    ## Description

    Unsanitized user input in XML External Entity (XXE) processing can lead to security vulnerabilities. This issue arises when XML input containing a reference to an external entity is processed without proper sanitization, potentially allowing attackers to access or interact with external systems.

    ## Remediations

    - **Do not** parse XML input containing external entities from untrusted sources. Doing so allows potential attackers to exploit XXE vulnerabilities and gain access to unauthorized data or systems.

    ## References

    - [OWASP XML External Entity (XXE) prevention cheat sheet](https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html)
  cwe_id:
    - 611
  id: go_lang_xml_external_entity_vulnerability
  documentation_url: https://docs.bearer.com/reference/rules/go_lang_xml_external_entity_vulnerability
