imports:
  - go_shared_lang_dynamic_input_combined
patterns:
  - pattern: $<XML>.Unmarshal($<USER_INPUT>$<...>)
    filters:
      - variable: XML
        detection: go_lang_xml_external_entity_vulnerability_xml_init
      - variable: USER_INPUT
        detection: go_shared_lang_dynamic_input_combined
auxiliary:
  - id: go_lang_xml_external_entity_vulnerability_xml_init
    patterns:
      - import $<!>"encoding/xml"
      - |
        import (
          $<!>"encoding/xml"
        )
languages:
  - go
severity: high
metadata:
  description: Unsanitized user input in XML External Entity
  remediation_message: |
    ## Description
    Avoid parsing untrusted data as XML. Such data could include URIs that resolve to resources that are outside of the current context, leading to XML External Entity (XXE) injection.

    ## Remediations

    ‚ùå Do not enable parsing of external entities.

    ## Resources
    - [OWASP XML External Entity (XXE) prevention cheat sheet](https://cheatsheetseries.owasp.org/cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html)
  cwe_id:
    - 611
  id: go_lang_xml_external_entity_vulnerability
  documentation_url: https://docs.bearer.com/reference/rules/go_lang_xml_external_entity_vulnerability
